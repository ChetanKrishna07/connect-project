<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="homeNav.css" />
    <link rel="stylesheet" href="style.css" />
    <title>home</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      $(document).ready(function () {
        $.ajax({
          url: "http://api.openweathermap.org/data/2.5/weather?q=vellore,india&APPID=4573c189d467ca1814c1c10000060792",
          dataType: "json",
          type: "GET",

          success: function (json) {
            var temp = Math.round(json.main.temp - 273.15);
            $("#city-weather-temperature").html(temp + "° C");
            $("#city-weather-description").html(json.weather[0].description);
            $("#city-name").html(json.name);
            $("img#city-weather-icon").attr(
              "src",
              "http://openweathermap.org/img/w/" + json.weather[0].icon + ".png"
            );
          },
          error: function (xhr, status, errorThrown) {
            //do something if there was an error. Right now it will just show the default values in the html
          },
        });
      });
    </script>
  </head>

  <body>
    <link
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      rel="stylesheet"
    />

    <nav>
      <ul id="logo-name" class="logo-name">
        <li><span>CONNECT</span></li>
        <img id="logo" src="images/logo.jpg" alt="logo" />
      </ul>
      <ul class="link-match" id="link-match">
        <li>
          <input
            type="search"
            name="search-box-frnd"
            id="search-box-frnd"
            placeholder="Search Users"
          />
        </li>
        <li><a href="home.html">Home</a></li>
        <li><a href="ProfilePage.html">Profile</a></li>
        <li><a href="messages.html">Messages</a></li>
        <li><a href="login.html" id="logout">Logout</a></li>
      </ul>
      <ul class="menu">
        <li>
          <a href="javascript:void(0);" id="menu" onclick="open_close()">☰</a>
        </li>
      </ul>
    </nav>

    <div class="main-container">
      <!-- left partition -->
      <div class="container1">
        <!-- left-sidebar -->
        <div class="left-sidebar">
          <div class="weather">
            <!-- <img src="img_home/weatherbg.webp" alt=""> -->
            <div
              class="city-weather-temperature"
              id="city-weather-temperature"
            ></div>
            <div class="city-name" id="city-name"></div>
            <div
              class="city-weather-description"
              id="city-weather-description"
            ></div>

            <img
              src="http://openweathermap.org/img/w/01d.png"
              alt="weather-icon"
              class="city-weather-icon"
              id="city-weather-icon"
            />
          </div>
        </div>
        <!-- main-content  -->
        <div class="main-content">
          <div class="create-post">
            <div class="user-profile">
              <img src="img_home\me.png" alt="" id="dp" />
              <div>
                <p id="name">Radhika Nathani</p>
                <i class="fa fa-globe"></i>
                <small>Public</small>
              </div>
            </div>

            <div class="post-inside">
              <textarea
                name=""
                id=""
                cols="30"
                rows="5"
                placeholder="What is on your mind?"
              ></textarea>
            </div>
            <div class="icons">
              <a href=""><i class="fa fa-image">Image</i></a>
              <a href=""><i class="fa fa-video-camera">Video</i></a>
            </div>
          </div>

          <div class="post_container">
            <div class="user-profile">
              <img src="img_home\me.png" alt="" />
              <div>
                <p>Radhika Nathani</p>
                <i class="fa fa-globe"></i>
                <span>October 18 2022, 4:22 pm</span>
              </div>
            </div>
            <p class="post-text">
              Follow <span>@Mywebiste</span> Youtube Channel to watch more
              videos and get daily notification on websit developmet.
              <a href="">#Mywebsite</a>
            </p>
            <img src="img_home\post.jpg" alt="" class="post-img" />

            <div class="post-row">
              <div class="activity-icons">
                <div>
                  <i class="fa fa-thumbs-up">&nbsp; 12k</i>
                  <i class="fa fa-comment">&nbsp;2k</i>
                  <i class="fa fa-share">&nbsp;500</i>
                </div>
              </div>
            </div>
          </div>
          <div class="post_container">
            <div class="user-profile">
              <img src="img_home\me.png" alt="" />
              <div>
                <p>Radhika Nathani</p>
                <i class="fa fa-globe"></i>
                <span>October 18 2022, 4:22 pm</span>
              </div>
            </div>
            <p class="post-text">
              Follow <span>@Mywebiste</span> Youtube Channel to watch more
              videos and get daily notification on websit developmet.
              <a href="">#Mywebsite</a>
            </p>
            <img src="img_home\post.jpg" alt="" class="post-img" />

            <div class="post-row">
              <div class="activity-icons">
                <div>
                  <i class="fa fa-thumbs-up">&nbsp; 12k</i>
                  <i class="fa fa-comment">&nbsp;2k</i>
                  <i class="fa fa-share">&nbsp;500</i>
                </div>
              </div>
            </div>
          </div>
          <div class="post_container">
            <div class="user-profile">
              <img src="img_home\me.png" alt="" />
              <div>
                <p>Radhika Nathani</p>
                <i class="fa fa-globe"></i>
                <span>October 18 2022, 4:22 pm</span>
              </div>
            </div>
            <p class="post-text">
              Follow <span>@Mywebiste</span> Youtube Channel to watch more
              videos and get daily notification on websit developmet.
              <a href="">#Mywebsite</a>
            </p>
            <img src="img_home\post.jpg" alt="" class="post-img" />

            <div class="post-row">
              <div class="activity-icons">
                <div>
                  <i class="fa fa-thumbs-up">&nbsp; 12k</i>
                  <i class="fa fa-comment">&nbsp;2k</i>
                  <i class="fa fa-share">&nbsp;500</i>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- right-sidebar   -->
        <div class="right-sidebar">
          <div class="white">
            <div class="suggestions">
              <h4>Friends</h4>
              <a href="friends.html" style="text-decoration: none">See all</a>
            </div>
            <hr />

            <div class="suggest" id="friends">
              <div class="suggestion_friend">
                <div class="img_name" style="display: flex">
                  <img src="img_home\default_profile.jpeg" alt="" />
                  <h6>Arun</h6>
                </div>
                <a href=""><b>Follow</b></a>
              </div>
              <div class="suggestion_friend">
                <div class="img_name" style="display: flex">
                  <img src="img_home\default_profile.jpeg" alt="" />
                  <h6>Bhavesh</h6>
                </div>
                <a href=""><b>Follow</b></a>
              </div>

              <div class="suggestion_friend">
                <div class="img_name" style="display: flex">
                  <img src="img_home\default_profile.jpeg" alt="" />
                  <h6>Chetan</h6>
                </div>
                <a href=""><b>Follow</b></a>
              </div>

              <div class="suggestion_friend">
                <div class="img_name" style="display: flex">
                  <img src="img_home\default_profile.jpeg" alt="" />
                  <h6>Darshan</h6>
                </div>
                <a href=""><b>Follow</b></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="loginCheck.js"></script>
    <script>
      function open_close() {
        var x = document.getElementById("link-match");
        var y = document.getElementById("menu");
        if (x.className === "link-match") {
          x.className += " responsive";
          y.innerHTML = "&#10006";
        } else {
          x.className = "link-match";
          y.innerHTML = "☰";
        }
      }
    </script>
    <script>
      const uid = sessionStorage.getItem("uname");

      var getUserDatails = async () => {
        let headersList = {
          "Content-Type": "application/json",
        };

        let body = {
          uid: uid,
        };

        let getOptions = {
          url: "http://localhost:3000/getuserdetails",
          method: "POST",
          headers: headersList,
          data: body,
        };

        var userDetails = await axios.request(getOptions);
        const user = userDetails.data;
        console.log(user);

        document.getElementById("name").innerHTML = user.uid;
        if (user.dp != null) {
          document.getElementById("dp").src = user.dp;
        }

        var friendsHTML = "";

        let friends = user.friends;
        for (friend of friends) {
          let img = await axios.request({
            url: "http://localhost:3000/getDp",
            method: "POST",
            headers: headersList,
            data: {
              uid: friend,
            },
          });

          friendsHTML += `<div class="suggestion_friend">
                <div class="img_name" style="display: flex">
                  <img src="${img.data}" alt="" />
                  <h6>${friend}</h6>
                </div>
                <a href="messages.html"><b>Message</b></a>
              </div>`;
        }

        document.getElementById("friends").innerHTML = friendsHTML;
      };

      getUserDatails();
    </script>
  </body>
</html>
